{{ define "main" }}
<div class="mb-4">
    <div class="flex justify-between w-full items-end">
        <h3 class="text-3xl font-semibold">
            #{{ .Title }}
        </h3>
        <div class="text-right mb-1">
            <span class="h-max pb-1">
                <p class="text-xs font-mono text-gray-500">
                    {{ .Pages | len }} {{ if eq (.Pages | len) 1 }}item{{ else }}items{{ end }}
                </p>
            </span>
        </div>
    </div>
    <hr />

    {{ if gt (len .Pages) 0 }}
        {{ $sortedPages := sort .Pages "Date" "desc" }}
        {{ $paginator := .Paginate $sortedPages }}

        <section class="mt-4">
            {{ range $paginator.Pages }}
                {{ if eq .Type "notes" }}
                    {{/* Notes rendering - matches notes/list.html structure */}}
                    <article class="hover:bg-white border border-mondrian_white hover:border-mondrian_black transition-colors mb-2 p-2">
                        <div class="flex flex-col">
                            <a href="{{ .RelPermalink }}" class="w-full text-center shadow-mondrian px-1 py-0.5 border border-black font-mono transition-colors bg-mondrian_white hover:bg-mondrian_red hover:text-mondrian_white text-xs mb-2">
                                {{ .Title }} →
                            </a>
                            <div class="flex-col w-full">
                                <div class="text-sm leading-relaxed mb-1">
                                    {{ .Content }}
                                    <hr class="w-full border-black" />
                                </div>
                                <footer class="flex flex-wrap items-center gap-3 text-xs font-mono text-gray-500">
                                    <div class="flex flex-col gap-0.5">
                                      <span>
                                        posted: {{ .Date.Format "2006-01-02" }} {{ .Date.Format "15:04" }}
                                      </span>
                                      {{ if .Lastmod }}
                                      {{ $dateOnly := .Date.Format "2006-01-02" }}
                                      {{ $lastmodOnly := .Lastmod.Format "2006-01-02" }}
                                      {{ if ne $dateOnly $lastmodOnly }}
                                      <span>
                                        updated: {{ .Lastmod.Format "2006-01-02" }} {{ .Lastmod.Format "15:04" }}
                                      </span>
                                      {{ end }}
                                      {{ end }}
                                    </div>
                                  {{ with .Params.tags }}
                                  <div class="flex flex-wrap gap-1">
                                    {{ range . }}
                                    <a href="/tags/{{ . | urlize }}/" class="hover:underline decoration-mondrian_yellow transition-colors hover:text-mondrian_black">
                                      #{{ . }}
                                    </a>
                                    {{ end }}
                                  </div>
                                  {{ end }}
                                </footer>
                            </div>
                        </div>
                    </article>
                {{ else if eq .Type "feed" }}
                    {{/* Feed rendering - matches feed/list.html structure */}}
                    <article class="hover:bg-white border border-mondrian_white hover:border-mondrian_black transition-colors mb-2 p-1">
                        <div class="flex">
                            <div class="w-8 mr-4">
                                <a href="{{ .RelPermalink }}" class="h-min shadow-mondrian px-1 py-0.5 text-black border border-black font-mono transition-colors bg-mondrian_white hover:bg-mondrian_red hover:text-mondrian_white text-xs">
                                  {{ .Title }}
                                </a>
                            </div>
                            <div class="flex-col w-full">
                                <div class="text-sm leading-relaxed mb-1">
                                    {{ .Content }}
                                    <hr class="w-full border-black" />
                                </div>
                                <footer class="flex flex-wrap items-center gap-3 text-xs font-mono text-gray-500">
                                    <span>
                                      {{ .Date.Format "2006-01-02" }}
                                      {{ .Date.Format "15:04" }}
                                    </span>
                                  {{ with .Params.tags }}
                                  <div class="flex flex-wrap gap-1">
                                    {{ range . }}
                                    <a href="/tags/{{ . | urlize }}/" class="hover:underline decoration-mondrian_yellow transition-colors hover:text-mondrian_black">
                                      #{{ . }}
                                    </a>
                                    {{ end }}
                                  </div>
                                  {{ end }}
                                </footer>
                            </div>
                        </div>
                    </article>
                {{ else }}
                    {{/* Fallback for other content types */}}
                    <article class="border-b border-b-gray-300 hover:bg-mondrian_white pb-4 transition-colors">
                        <div class="flex justify-between items-start mb-2">
                            <div class="flex-1">
                                <h4 class="text-lg font-semibold mb-1">
                                    <a href="{{ .RelPermalink }}" class="hover:underline">{{ .Title }}</a>
                                </h4>
                                <div class="text-sm leading-relaxed">
                                    {{ .Summary }}
                                </div>
                            </div>
                            <div class="ml-4 text-right">
                                <span class="text-xs font-mono text-gray-500">
                                    {{ .Date.Format "2006-01-02" }}<br>
                                    {{ .Date.Format "15:04" }}
                                </span>
                            </div>
                        </div>

                        <footer class="flex flex-wrap items-center gap-2 text-xs">
                            {{ with .Params.tags }}
                            <div class="flex flex-wrap gap-1">
                                {{ range . }}
                                <a href="/tags/{{ . | urlize }}/"
                                   class="px-1 py-0.5 text-black border border-gray-400 font-mono transition-colors bg-mondrian_white hover:bg-mondrian_yellow hover:border-black text-xs">
                                    #{{ . }}
                                </a>
                                {{ end }}
                            </div>
                            {{ end }}

                            <a href="{{ .RelPermalink }}"
                               class="px-2 py-0.5 text-black border border-black font-mono transition-colors bg-mondrian_white hover:bg-mondrian_red hover:text-mondrian_white text-xs">
                                READ MORE
                            </a>
                        </footer>
                    </article>
                {{ end }}
            {{ end }}

            {{/* Pagination */}}
            {{ if gt $paginator.TotalPages 1 }}
            <nav class="flex justify-center mt-8">
                <div class="flex items-center gap-1">
                    {{ if $paginator.HasPrev }}
                    <a href="{{ $paginator.Prev.URL }}"
                       class="px-3 py-1 text-xs text-black border border-black shadow-mondrian font-mono transition-colors bg-mondrian_white hover:bg-mondrian_blue hover:text-mondrian_white">
                        ← NEWER
                    </a>
                    {{ end }}

                    {{ range $paginator.Pagers }}
                    {{ if eq . $paginator }}
                    <span class="px-3 py-1 text-xs bg-mondrian_red text-white border border-black font-mono">
                        {{ .PageNumber }}
                    </span>
                    {{ else }}
                    <a href="{{ .URL }}"
                       class="px-3 py-1 text-xs text-black border border-black shadow-mondrian font-mono transition-colors bg-mondrian_white hover:bg-mondrian_yellow">
                        {{ .PageNumber }}
                    </a>
                    {{ end }}
                    {{ end }}

                    {{ if $paginator.HasNext }}
                    <a href="{{ $paginator.Next.URL }}"
                       class="px-3 py-1 text-xs text-black border border-black shadow-mondrian font-mono transition-colors bg-mondrian_white hover:bg-mondrian_blue hover:text-mondrian_white">
                        OLDER →
                    </a>
                    {{ end }}
                </div>
            </nav>
            {{ end }}
        </section>
    {{ else }}
        <div class="mt-6">
            <p class="text-sm text-gray-500">No items found with this tag.</p>
        </div>
    {{ end }}
</div>
{{ end }}